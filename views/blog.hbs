<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <h1>Blog page</h1>
</head>
<body>
Commenting as <b id="user">{{user}}</b>
<br>
<br>
<br>
<b id="name">{{name}}</b>
<br>
<hr>
{{body}}
<hr>
<br>
-by {{author}}
<br>
<hr>
<br>
<br>
<br>
<b>Comments</b>
<p id="displaycomments">
  {{#each comments}}
  <hr>
  {{this.text}}
  <br>
  -by {{this.author}}
  {{/each}}
</p>
<br>
<br>
<br>
<form id="form">
<input id="comment" name= "commentText" type="text" placeholder="Comment"></input>
<br>
<button id="submit" onlick="comment">Submit</button>
</form>
<script src="/jquery.js"></script>
<script>
  $("#form").submit(function(event){
    var comment = $("#comment").val();
    var user = document.getElementById("user").innerHTML;
    console.log(user);
    var name= document.getElementById("name").innerHTML;
    console.log(name);
    console.log(comment);
    var data = {
      comment,
    }
    $.ajax({
        type:'post',
        url:`/blogs/comments/${name}`,
        data:data,
        dataType:"application/x-www-form-urlencoded",
      });
    $("#displaycomments").append(`<hr>${comment}<br>-by ${user}`);
    event.preventDefault();
  });


  // var comment=function()
  // {
  //   var text = $('input[name=comment]').val();
  //   console.log(text);
  //   // var http = new XMLHttpRequest();
  //   // htpp.open("POST", "/blogs/{{id}}/comments", true);
  //   // http.setRequestHeader("Content-type", "application/json");
  //   // http.setRequestHeader("charset", "utf-8");
  //   // http.onload = function(){
  //   //   console.log("HI");
  //   // }
  //   // http.send(`{"text": "${text}",
  //   //   "author": "{{author}}"}`);
  // }
  // $("form").submit(function(event){
  //   console.log("Inside");
  //   console.log("/blog/{{id}}/comments")
  //   var data = {
  //     comment: $('input[name=comment]').val(),
  //     author: {{author}},
  //   }
  //   $.ajax({
  //     type:'post',
  //     url:'/blog/{{id}}/comments',
  //     data:data,
  //     dataType:"application/x-www-form-urlencoded",
  //   }).done(function(data){
  //     console.log(data);
  //   });
  //   event.preventDefault();
  // });
</script>
</body>
</html>
